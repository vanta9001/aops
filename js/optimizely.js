function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function ownKeys(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,r)}return o}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(o),!0).forEach((function(t){_defineProperty(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):ownKeys(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function _defineProperty(e,t,o){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}function _createClass(e,t,o){return t&&_defineProperties(e.prototype,t),o&&_defineProperties(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var r=o.call(e,t||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}window.optimizely=window.optimizely||[];var CRO=function(){"use strict";return _createClass((function e(){_classCallCheck(this,e)}),[{key:"checkForSuccessfulLoad",value:function(){return!Array.isArray(window.optimizely)}},{key:"sendEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(this.checkForSuccessfulLoad()){var i={};r&&(i.revenue=Math.round(100*r)),t&&(i.value=t),i=_objectSpread(_objectSpread({},i),o),optimizely.push({type:"event",eventName:e,tags:i})}}},{key:"loud",value:function(){this.checkForSuccessfulLoad()&&optimizely.push({type:"log",level:"DEBUG"})}},{key:"forceSync",value:function(){this.checkForSuccessfulLoad()&&optimizely.push({type:"sendEvents"})}},{key:"disable",value:function(){this.checkForSuccessfulLoad()&&optimizely.push({type:"optOut",isOptOut:!0})}},{key:"enable",value:function(){this.checkForSuccessfulLoad()&&optimizely.push({type:"optOut",isOptOut:!1})}},{key:"reload",value:function(){this.checkForSuccessfulLoad()&&optimizely.push({type:"activate"})}},{key:"handleIncomingCROUser",value:function(){var e=optimizely&&!Array.isArray(window.optimizely)?optimizely.get("visitor").visitorId:this.getCROCookie("optimizelyEndUserId");if(-1!==window.location.href.indexOf("croid")){var t=this.getCROUrlParameter();t!==e&&(this.setCROCookie(t),e=t)}return e}},{key:"addCROToLinks",value:function(e){e&&[t(AoPS.aops_url),t(AoPS.academy_url),t(AoPS.beast_url)].forEach((function(t){document.querySelectorAll("a[href*='"+t+"'").forEach((function(t){t.href+=(t.href.split("?")[1]?"&":"?")+"croid="+e}))}));function t(e){try{return new URL(e).hostname}catch(t){return console.error("Invalid URL:",t),null}}}},{key:"getCROCookie",value:function(){var e=document.cookie.match("optimizelyEndUserId=([^;]*)");return e?e[1]:void 0}},{key:"setCROCookie",value:function(e){var t=window.location.hostname.split(".").slice(-2).join("."),o=new Date;o.setTime(o.getTime()+15552e6),document.cookie="optimizelyEndUserId="+e+";domain="+t+";path=/;expires="+o.toGMTString()}},{key:"getCROUrlParameter",value:function(){var e,t,o=window.location.search.substring(1).split("&");for(t=0;t<o.length;t++)if("croid"===(e=o[t].split("="))[0])return void 0===e[1]||decodeURIComponent(e[1])}},{key:"until",value:function(e){if(this.checkForSuccessfulLoad())return optimizely.get("utils").waitUntil(e).catch((function(e){console.error("E_OPTIMIZELY_UNTIL",e)}))}}])}();AoPS.CRO=new CRO,window.addEventListener("load",(function(){var e=AoPS.CRO.handleIncomingCROUser();AoPS.CRO.addCROToLinks(e)}));
;//# sourceMappingURL=optimizely.js.map